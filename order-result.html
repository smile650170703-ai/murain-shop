<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>XUYUAN | 訂單完成</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-color: #050505;
      --card-bg: #111;
      --text-main: #fff;
      --text-muted: #888;
      --gold-primary: #D4AF37; 
      --gold-light: #F3E5AB;
      --border-color: rgba(255, 255, 255, 0.1);
      --font-serif: 'Playfair Display', serif;
      --font-sans: 'Lato', sans-serif;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    body {
      margin: 0;
      font-family: var(--font-sans);
      background-color: var(--bg-color);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
    }

    /* --- 品牌 Logo --- */
    .brand {
      font-family: var(--font-serif);
      font-size: 24px;
      letter-spacing: 0.2em;
      color: var(--gold-primary);
      margin-bottom: 40px;
      text-transform: uppercase;
    }

    /* --- 訂單卡片 (精品收據風格) --- */
    .receipt-card {
      width: 100%;
      max-width: 400px;
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      padding: 40px 30px;
      text-align: center;
      position: relative;
      border-radius: 2px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    }

    /* 頂部裝飾線 */
    .receipt-card::before {
      content: '';
      position: absolute; top: 0; left: 50%; transform: translateX(-50%);
      width: 60px; height: 2px; background: var(--gold-primary);
    }

    .success-icon {
      font-size: 40px; color: var(--gold-primary); margin-bottom: 20px;
      display: inline-block;
      text-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
    }

    .title {
      font-family: var(--font-serif);
      font-size: 28px; color: #fff; margin-bottom: 8px;
      font-weight: 400; letter-spacing: 0.05em;
    }
    .subtitle {
      font-size: 12px; color: var(--text-muted); letter-spacing: 0.1em;
      text-transform: uppercase; margin-bottom: 30px;
    }

    /* 分隔線 */
    .divider {
      height: 1px; background: var(--border-color); width: 100%; margin: 20px 0;
    }

    /* 訂單資訊 */
    .info-row {
      display: flex; justify-content: space-between; align-items: baseline;
      margin-bottom: 12px;
    }
    .info-label {
      font-size: 11px; color: #666; text-transform: uppercase; letter-spacing: 0.1em;
    }
    .info-val {
      font-family: var(--font-serif); font-size: 16px; color: #eee;
    }
    .highlight-val {
      color: var(--gold-light); font-size: 20px;
    }

    /* 提示訊息 */
    .note-box {
      margin-top: 30px;
      background: rgba(255,255,255,0.03);
      padding: 16px;
      border-radius: 4px;
    }
    .note-text {
      font-size: 12px; color: #888; line-height: 1.6; text-align: left;
    }

    /* 按鈕 */
    .btn-home {
      display: inline-block;
      margin-top: 40px;
      padding: 14px 40px;
      border: 1px solid var(--gold-primary);
      color: var(--gold-primary);
      background: transparent;
      font-size: 12px; letter-spacing: 0.15em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all 0.3s;
      text-decoration: none;
    }
    .btn-home:hover {
      background: var(--gold-primary);
      color: #000;
    }

    /* 錯誤狀態 */
    .error-state { color: var(--text-muted); font-size: 13px; line-height: 1.6; }

  </style>
</head>
<body>

  <div class="brand">XUYUAN</div>

  <div class="receipt-card">
    <div id="okBlock">
      <div class="success-icon">✓</div>
      <h1 class="title">Thank You</h1>
      <div class="subtitle">Order Confirmed</div>

      <div class="divider"></div>

      <div class="info-row">
        <span class="info-label">Order No.</span>
        <span class="info-val" id="orderIdText">--</span>
      </div>
      
      <div class="info-row">
        <span class="info-label">Total Amount</span>
        <span class="info-val highlight-val" id="amountText">--</span>
      </div>

      <div class="divider"></div>

      <div class="note-box">
        <div class="note-text">
          ● 系統已收到您的訂單。<br>
          ● 請截圖保存此頁面，或記下訂單編號。<br>
          ● 出貨進度請至官方 LINE 查詢。<br>
          ● 若有任何問題，歡迎私訊客服。
        </div>
      </div>
    </div>

    <!-- 錯誤/無編號狀態 -->
    <div id="errorBlock" class="error-state" style="display:none;">
      <div class="success-icon" style="color:#666;">!</div>
      <h1 class="title" style="font-size:20px;">Order Processing</h1>
      <p style="margin-top:10px;">
        目前無法讀取訂單編號。<br>
        若是剛完成刷卡，請稍待系統入帳通知，<br>
        或直接至官方 LINE 確認訂單狀態。
      </p>
    </div>

    <button id="backLineBtn" class="btn-home">Return to LINE</button>
  </div>

<script>
  const qs = new URLSearchParams(location.search);
  const orderId = qs.get('order_id') || '';
  const total = qs.get('total') || '';

  const orderIdText = document.getElementById('orderIdText');
  const amountText = document.getElementById('amountText');
  const okBlock = document.getElementById('okBlock');
  const errorBlock = document.getElementById('errorBlock');

  // 初始化顯示邏輯
  if (orderId) {
    // 正常訂單
    orderIdText.textContent = '#' + orderId;
    if (total) {
      const n = Number(total) || 0;
      amountText.textContent = 'NT$ ' + n.toLocaleString();
    } else {
      amountText.textContent = 'Pending';
    }
  } else {
    // 無單號 (可能是金流跳轉回來，或重新整理)
    okBlock.style.display = 'none';
    errorBlock.style.display = 'block';
  }

  // 回到官方 LINE 按鈕
  const lineBtn = document.getElementById('backLineBtn');
  if (lineBtn) {
    // ★ 請記得將下方 ID 換成您真實的官方帳號 ID
    const lineUrl = 'https://line.me/R/ti/p/@cc0857';

    lineBtn.addEventListener('click', () => {
      // 嘗試關閉視窗 (如果是 LIFF)，否則跳轉
      if (typeof liff !== 'undefined' && liff.isInClient()) {
        liff.closeWindow();
      } else {
        location.href = lineUrl;
      }
    });

    // 自動跳轉計時器 (可選)
    // setTimeout(() => { location.href = lineUrl; }, 5000);
  }
</script>

</body>
</html>
