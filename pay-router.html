<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>正在前往付款 / 結果頁…</title>
<style>
  body{font-family:-apple-system,BlinkMacSystemFont,"Noto Sans TC",Roboto;margin:0;padding:24px;background:#0b1222;color:#e2e8f0}
  .card{max-width:720px;margin:0 auto;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:16px;padding:16px}
  .muted{opacity:.8}
  a.button{display:inline-block;margin-top:12px;padding:10px 14px;border-radius:12px;background:#22d3ee;color:#0b1222;text-decoration:none;font-weight:700}
  code{background:rgba(255,255,255,.07);padding:2px 6px;border-radius:6px}
</style>
</head>
<body>
<div class="card">
  <h2>處理中</h2>
  <div id="msg" class="muted">請稍候…</div>
  <div id="links"></div>
</div>

<script>
  // === 依付款方式對應到你的金流 / 目的頁 ===
  const PAYUNI = 'https://api.payuni.com.tw/api/uop/receive_info/2/1/GOGO1586942584/8UoSwkh2D82d9G9Vqm2m';

  const LINKS = {
    // 線上付款
    'paid_card_once': PAYUNI,
    'paid_card_inst_3': PAYUNI,
    'paid_card_inst_6': PAYUNI,
    'paid_card_inst_9': PAYUNI,
    'paid_linepay': PAYUNI,
    'paid_af': PAYUNI,
    // 其餘留空 => 直接回訂單結果頁
  };

  const qs = new URLSearchParams(location.search);
  const pm = qs.get('pm') || '';
  const orderId = qs.get('order_id') || '';
  const total = qs.get('total') || '';
  const resultURL = `/order-result.html?order_id=${encodeURIComponent(orderId)}&total=${encodeURIComponent(total)}`;

  const msg = document.getElementById('msg');
  const links = document.getElementById('links');

  function go(url){ location.href = url; }

  (function main(){
    const target = LINKS[pm];
    if (target) {
      msg.innerHTML = `偵測到付款方式 <code>${pm}</code>，準備前往金流頁…`;
      const a = document.createElement('a');
      a.className = 'button';
      a.textContent = '若未自動前往，請點我繼續付款';
      a.href = target;
      links.appendChild(a);
      setTimeout(()=>go(target), 500);
    } else {
      msg.innerHTML = `此付款方式 <code>${pm||'(無)'}</code> 不需跳金流，將回訂單結果頁。`;
      const a = document.createElement('a');
      a.className = 'button';
      a.textContent = '前往訂單結果頁';
      a.href = resultURL;
      links.appendChild(a);
      setTimeout(()=>go(resultURL), 600);
    }
  })();
</script>
</body>
</html>
